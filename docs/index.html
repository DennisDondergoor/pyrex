<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>PyRex — Python Regex Course</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="app">

        <!-- Header -->
        <header id="header">
            <div class="header-content">
                <div class="header-left">
                    <button id="btn-back" class="btn-icon" title="Back to levels" aria-label="Back to levels" style="display:none">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M13 4L7 10L13 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </div>
                <h1 class="logo">PyRex</h1>
                <div class="header-right">
                    <button id="btn-auth" class="btn-text" title="Sign in">Sign in</button>
                </div>
            </div>
            <div id="sync-status" class="sync-status"></div>
        </header>

        <!-- View: Home -->
        <section id="view-home" class="view active">
            <p class="tagline">Learn Python regular expressions, step by step.</p>
            <div class="level-grid" id="level-grid">
                <!-- Populated by JS -->
            </div>
            <div class="home-footer">
                <button class="btn-reset" id="btn-reset-progress">Reset progress</button>
            </div>
        </section>

        <!-- View: Challenge -->
        <section id="view-challenge" class="view">
            <div class="challenge-nav">
                <div class="challenge-nav-left">
                    <button id="btn-prev" class="btn-icon" title="Previous challenge" aria-label="Previous challenge" style="display:none">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M13 4L7 10L13 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    <span class="level-tag" id="level-tag">Level 1</span>
                </div>
                <span class="challenge-counter" id="challenge-counter">1 / 3</span>
                <button id="btn-nav-next" class="btn-icon" title="Next challenge" aria-label="Next challenge" style="display:none">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M7 4L13 10L7 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>

            <h2 class="challenge-title" id="challenge-title"></h2>
            <p class="challenge-instruction" id="challenge-instruction"></p>

            <div class="concept-box" id="concept-box" style="display:none"></div>

            <div class="concept-actions" id="concept-actions" style="display:none">
                <button class="btn btn-primary" id="btn-start">Start</button>
            </div>

            <div class="test-string-box" id="test-string-box"></div>
            <div class="match-count" id="match-count"></div>

            <div class="regex-input-row" id="regex-input-row">
                <input
                    type="text"
                    id="regex-input"
                    class="regex-input"
                    aria-label="Regular expression pattern"
                    autocomplete="off"
                    autocorrect="off"
                    autocapitalize="off"
                    spellcheck="false"
                    placeholder="type your pattern"
                >
            </div>
            <div class="input-error" id="input-error" style="display:none">Invalid regular expression</div>

            <div class="char-picker-wrap">
            <div class="char-picker" id="char-picker">
                <button class="char-btn" type="button" data-char=".">.</button>
                <button class="char-btn" type="button" data-char="*">*</button>
                <button class="char-btn" type="button" data-char="+">+</button>
                <button class="char-btn" type="button" data-char="?">?</button>
                <button class="char-btn" type="button" data-char="|">|</button>
                <button class="char-btn" type="button" data-char="^">^</button>
                <button class="char-btn" type="button" data-char="$">$</button>
                <button class="char-btn" type="button" data-char="\">\</button>
                <button class="char-btn" type="button" data-char="[">[</button>
                <button class="char-btn" type="button" data-char="]">]</button>
                <button class="char-btn" type="button" data-char="(">(</button>
                <button class="char-btn" type="button" data-char=")">)</button>
                <button class="char-btn" type="button" data-char="{">{</button>
                <button class="char-btn" type="button" data-char="}">}</button>
                <button class="char-btn" type="button" data-char="-">-</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="*?">*?</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="+?">+?</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="??">??</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="\1">\1</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="\d">\d</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="\w">\w</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="\s">\s</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="\b">\b</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="\B">\B</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="\D">\D</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="\W">\W</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="\S">\S</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="(?:">(?:</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="(?&lt;">(?&lt;</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="(?=">(?=</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="(?!">(?!</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="(?&lt;=">(?&lt;=</button>
                <button class="char-btn char-btn-shorthand" type="button" data-char="(?&lt;!">(?&lt;!</button>

            </div>
            </div>

            <div class="hint-box" id="hint-box" style="display:none"></div>

            <div class="challenge-actions" id="challenge-actions">
                <button class="btn btn-secondary" id="btn-hint">Hint</button>
                <button class="btn btn-primary" id="btn-submit">Submit</button>
            </div>
            <div class="completed-banner" id="completed-banner" style="display:none">✓ Completed</div>
        </section>

        <!-- View: Result -->
        <section id="view-result" class="view">
            <div class="result-banner" id="result-banner">
                <span class="result-icon" id="result-icon"></span>
                <span id="result-text"></span>
            </div>

            <div id="your-pattern-section" style="display:none">
                <div class="result-pattern-caption">Your pattern: <code id="your-pattern-code"></code></div>
                <div class="test-string-box" id="your-test-box"></div>
            </div>

            <div id="correct-pattern-section">
                <div class="result-pattern-caption result-pattern-caption--correct">Correct pattern: <code id="correct-pattern-code"></code></div>
                <div class="test-string-box" id="result-test-box"></div>
            </div>

            <div class="explanation-box">
                <h4>Explanation</h4>
                <p id="explanation-text"></p>
            </div>

            <div class="result-actions">
                <button class="btn btn-primary" id="btn-try-again" style="display:none">Try Again</button>
                <button class="btn btn-primary" id="btn-next">Next Challenge</button>
                <button class="btn btn-secondary" id="btn-back-levels">Back to Levels</button>
            </div>
        </section>

        <!-- Modal: Reset Progress -->
        <div id="modal-reset" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modal-reset-heading">
            <div class="modal-content">
                <h2 id="modal-reset-heading">Reset all progress?</h2>
                <p>This will clear all your completed challenges. This cannot be undone.</p>
                <div class="modal-actions">
                    <button class="btn btn-secondary" id="btn-reset-cancel">Cancel</button>
                    <button class="btn btn-danger" id="btn-reset-confirm">Reset</button>
                </div>
            </div>
        </div>

    </div>

    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
    <script src="challenges.js"></script>
    <script src="firebase.js"></script>
    <script src="app.js"></script>
</body>
</html>
